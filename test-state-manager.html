<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŠ¶æ€ç®¡ç†å™¨æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #8B4513, #CD853F);
            min-height: 100vh;
            color: #2F1B14;
        }
        
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }
        
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.8);
        }
        
        .test-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .test-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .test-btn.danger {
            background: linear-gradient(45deg, #f44336, #d32f2f);
        }
        
        .test-btn.info {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        
        .status {
            background: linear-gradient(45deg, #e7f3ff, #cce7ff);
            border: 2px solid #b3d9ff;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .error {
            background: linear-gradient(45deg, #ffe7e7, #ffcccc);
            border: 2px solid #ffb3b3;
            color: #d00;
        }
        
        .success {
            background: linear-gradient(45deg, #e7ffe7, #ccffcc);
            border: 2px solid #b3ffb3;
            color: #0a0;
        }
        
        .data-display {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid #ddd;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        
        .achievement-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.8);
        }
        
        .achievement-item.unlocked {
            background: linear-gradient(45deg, #e7ffe7, #ccffcc);
            border: 2px solid #4CAF50;
        }
        
        .achievement-item.locked {
            background: rgba(240, 240, 240, 0.8);
            border: 2px solid #ccc;
            opacity: 0.6;
        }
        
        .achievement-icon {
            font-size: 24px;
            margin-right: 15px;
        }
        
        .achievement-info h4 {
            margin: 0 0 5px 0;
            color: #333;
        }
        
        .achievement-info p {
            margin: 0;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ® StateManager æµ‹è¯•é¡µé¢</h1>
        
        <div class="status" id="status">
            æ­£åœ¨åˆå§‹åŒ–çŠ¶æ€ç®¡ç†å™¨...
        </div>
        
        <!-- åŸºç¡€åŠŸèƒ½æµ‹è¯• -->
        <div class="test-section">
            <h3>åŸºç¡€åŠŸèƒ½æµ‹è¯•</h3>
            <div class="test-controls">
                <button class="test-btn" onclick="testSaveGameState()">ä¿å­˜æ¸¸æˆçŠ¶æ€</button>
                <button class="test-btn" onclick="testLoadGameState()">åŠ è½½æ¸¸æˆçŠ¶æ€</button>
                <button class="test-btn" onclick="testUpdateHighScore()">æ›´æ–°æœ€é«˜åˆ†</button>
                <button class="test-btn" onclick="testCalculateScore()">è®¡ç®—åˆ†æ•°</button>
                <button class="test-btn danger" onclick="testClearGameState()">æ¸…é™¤çŠ¶æ€</button>
            </div>
            <div class="data-display" id="basic-test-result"></div>
        </div>
        
        <!-- ç»Ÿè®¡æ•°æ®æµ‹è¯• -->
        <div class="test-section">
            <h3>ç»Ÿè®¡æ•°æ®</h3>
            <div class="test-controls">
                <button class="test-btn" onclick="testUpdateStatistics()">æ›´æ–°ç»Ÿè®¡</button>
                <button class="test-btn info" onclick="displayStatistics()">æ˜¾ç¤ºç»Ÿè®¡</button>
                <button class="test-btn danger" onclick="testResetStatistics()">é‡ç½®ç»Ÿè®¡</button>
            </div>
            <div class="stats-grid" id="statistics-display"></div>
        </div>
        
        <!-- æˆå°±ç³»ç»Ÿæµ‹è¯• -->
        <div class="test-section">
            <h3>æˆå°±ç³»ç»Ÿ</h3>
            <div class="test-controls">
                <button class="test-btn" onclick="testUnlockAchievement()">è§£é”æˆå°±</button>
                <button class="test-btn info" onclick="displayAchievements()">æ˜¾ç¤ºæˆå°±</button>
                <button class="test-btn" onclick="testCheckAchievements()">æ£€æŸ¥æˆå°±</button>
            </div>
            <div id="achievements-display"></div>
        </div>
        
        <!-- å­˜å‚¨åŠŸèƒ½æµ‹è¯• -->
        <div class="test-section">
            <h3>å­˜å‚¨åŠŸèƒ½</h3>
            <div class="test-controls">
                <button class="test-btn" onclick="testStorageOperations()">å­˜å‚¨æ“ä½œ</button>
                <button class="test-btn info" onclick="testStorageUsage()">å­˜å‚¨ä½¿ç”¨æƒ…å†µ</button>
                <button class="test-btn" onclick="testDataExport()">å¯¼å‡ºæ•°æ®</button>
                <button class="test-btn" onclick="testDataImport()">å¯¼å…¥æ•°æ®</button>
                <button class="test-btn danger" onclick="testResetGame()">å®Œå…¨é‡ç½®</button>
            </div>
            <div class="data-display" id="storage-test-result"></div>
        </div>
        
        <!-- æµ‹è¯•æ—¥å¿— -->
        <div class="test-section">
            <h3>æµ‹è¯•æ—¥å¿—</h3>
            <div class="data-display" id="test-log"></div>
        </div>
    </div>

    <!-- å¼•å…¥çŠ¶æ€ç®¡ç†å™¨ -->
    <script src="js/managers/StateManager.js"></script>
    
    <script>
        let stateManager = null;
        let testCounter = 0;
        
        // åˆå§‹åŒ–æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            try {
                stateManager = new StateManager();
                
                // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
                bindStateManagerEvents();
                
                updateStatus('çŠ¶æ€ç®¡ç†å™¨åˆå§‹åŒ–æˆåŠŸï¼', 'success');
                log('StateManager åˆå§‹åŒ–å®Œæˆ');
                
                // æ˜¾ç¤ºåˆå§‹æ•°æ®
                displayStatistics();
                displayAchievements();
                
            } catch (error) {
                updateStatus('çŠ¶æ€ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥: ' + error.message, 'error');
                log('ERROR: ' + error.message);
            }
        });
        
        // ç»‘å®šçŠ¶æ€ç®¡ç†å™¨äº‹ä»¶
        function bindStateManagerEvents() {
            stateManager.on('newHighScore', (data) => {
                log(`æ–°æœ€é«˜åˆ†: ${data.newScore} (ä¹‹å‰: ${data.oldScore})`);
                showNotification('ğŸ‰ æ–°æœ€é«˜åˆ†ï¼', 'success');
            });
            
            stateManager.on('achievementUnlocked', (data) => {
                log(`æˆå°±è§£é”: ${data.achievement} - ${data.data.name}`);
                showNotification(`ğŸ† æˆå°±è§£é”: ${data.data.name}`, 'success');
                displayAchievements();
            });
            
            stateManager.on('statisticsUpdated', (data) => {
                log('ç»Ÿè®¡æ•°æ®å·²æ›´æ–°');
                displayStatistics();
            });
            
            stateManager.on('gameStateSaved', (data) => {
                log('æ¸¸æˆçŠ¶æ€å·²ä¿å­˜');
            });
            
            stateManager.on('gameStateLoaded', (data) => {
                log('æ¸¸æˆçŠ¶æ€å·²åŠ è½½');
            });
            
            stateManager.on('storageError', (data) => {
                log(`å­˜å‚¨é”™è¯¯: ${data.error.message}`);
                showNotification('å­˜å‚¨æ“ä½œå¤±è´¥', 'error');
            });
        }
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus(message, type = '') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = 'status ' + type;
        }
        
        // è®°å½•æ—¥å¿—
        function log(message) {
            const logEl = document.getElementById('test-log');
            const timestamp = new Date().toLocaleTimeString();
            logEl.innerHTML += `[${timestamp}] ${message}\n`;
            logEl.scrollTop = logEl.scrollHeight;
        }
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `status ${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1000;
                min-width: 200px;
                animation: slideIn 0.3s ease-out;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // æµ‹è¯•ä¿å­˜æ¸¸æˆçŠ¶æ€
        function testSaveGameState() {
            const mockGameState = {
                grid: Array(16).fill(null).map((_, i) => i % 4 === 0 ? { value: 2 * (i + 1) } : null),
                score: Math.floor(Math.random() * 10000),
                moves: Math.floor(Math.random() * 100),
                playTime: Math.floor(Math.random() * 300000),
                isGameOver: false,
                isWon: false,
                skillCooldowns: { threeHeadsSixArms: 0, qiankunCircle: 5000 },
                nezhaLevel: 2,
                consecutiveMerges: 3
            };
            
            stateManager.saveGameState(mockGameState);
            
            document.getElementById('basic-test-result').textContent = 
                'ä¿å­˜çš„æ¸¸æˆçŠ¶æ€:\n' + JSON.stringify(mockGameState, null, 2);
            
            log(`ä¿å­˜æ¸¸æˆçŠ¶æ€: åˆ†æ•°=${mockGameState.score}, ç§»åŠ¨=${mockGameState.moves}`);
            updateStatus('æ¸¸æˆçŠ¶æ€ä¿å­˜æˆåŠŸ', 'success');
        }
        
        // æµ‹è¯•åŠ è½½æ¸¸æˆçŠ¶æ€
        function testLoadGameState() {
            const loadedState = stateManager.loadGameState();
            
            if (loadedState) {
                document.getElementById('basic-test-result').textContent = 
                    'åŠ è½½çš„æ¸¸æˆçŠ¶æ€:\n' + JSON.stringify(loadedState, null, 2);
                log(`åŠ è½½æ¸¸æˆçŠ¶æ€: åˆ†æ•°=${loadedState.score}, ç§»åŠ¨=${loadedState.moves}`);
                updateStatus('æ¸¸æˆçŠ¶æ€åŠ è½½æˆåŠŸ', 'success');
            } else {
                document.getElementById('basic-test-result').textContent = 'æ²¡æœ‰æ‰¾åˆ°ä¿å­˜çš„æ¸¸æˆçŠ¶æ€';
                log('æ²¡æœ‰æ‰¾åˆ°ä¿å­˜çš„æ¸¸æˆçŠ¶æ€');
                updateStatus('æ²¡æœ‰ä¿å­˜çš„æ¸¸æˆçŠ¶æ€', 'error');
            }
        }
        
        // æµ‹è¯•æ›´æ–°æœ€é«˜åˆ†
        function testUpdateHighScore() {
            const randomScore = Math.floor(Math.random() * 50000) + 1000;
            const isNewRecord = stateManager.updateHighScore(randomScore);
            const currentHighScore = stateManager.getHighScore();
            
            document.getElementById('basic-test-result').textContent = 
                `æµ‹è¯•åˆ†æ•°: ${randomScore}\nå½“å‰æœ€é«˜åˆ†: ${currentHighScore}\næ˜¯å¦æ–°çºªå½•: ${isNewRecord}`;
            
            log(`æµ‹è¯•æœ€é«˜åˆ†: ${randomScore}, å½“å‰æœ€é«˜åˆ†: ${currentHighScore}, æ–°çºªå½•: ${isNewRecord}`);
            updateStatus(isNewRecord ? 'åˆ›é€ æ–°çºªå½•ï¼' : 'æœªè¶…è¿‡æœ€é«˜åˆ†', isNewRecord ? 'success' : 'info');
        }
        
        // æµ‹è¯•åˆ†æ•°è®¡ç®—
        function testCalculateScore() {
            const testCases = [
                { value: 4, combo: 1, skill: null },
                { value: 8, combo: 2, skill: null },
                { value: 16, combo: 3, skill: 'threeHeadsSixArms' },
                { value: 32, combo: 4, skill: 'qiankunCircle' },
                { value: 64, combo: 5, skill: 'transformation' }
            ];
            
            let results = 'åˆ†æ•°è®¡ç®—æµ‹è¯•:\n';
            testCases.forEach((testCase, index) => {
                const score = stateManager.calculateMergeScore(
                    testCase.value, 
                    testCase.combo, 
                    testCase.skill
                );
                results += `${index + 1}. å€¼:${testCase.value}, è¿å‡»:${testCase.combo}, æŠ€èƒ½:${testCase.skill || 'æ— '} => åˆ†æ•°:${score}\n`;
            });
            
            document.getElementById('basic-test-result').textContent = results;
            log('åˆ†æ•°è®¡ç®—æµ‹è¯•å®Œæˆ');
            updateStatus('åˆ†æ•°è®¡ç®—æµ‹è¯•å®Œæˆ', 'success');
        }
        
        // æµ‹è¯•æ¸…é™¤æ¸¸æˆçŠ¶æ€
        function testClearGameState() {
            stateManager.clearGameState();
            document.getElementById('basic-test-result').textContent = 'æ¸¸æˆçŠ¶æ€å·²æ¸…é™¤';
            log('æ¸¸æˆçŠ¶æ€å·²æ¸…é™¤');
            updateStatus('æ¸¸æˆçŠ¶æ€å·²æ¸…é™¤', 'success');
        }
        
        // æµ‹è¯•æ›´æ–°ç»Ÿè®¡
        function testUpdateStatistics() {
            const mockGameData = {
                score: Math.floor(Math.random() * 20000) + 1000,
                moves: Math.floor(Math.random() * 200) + 50,
                playTime: Math.floor(Math.random() * 600000) + 60000,
                isWon: Math.random() > 0.7,
                isGameOver: true,
                maxTile: [64, 128, 256, 512, 1024, 2048][Math.floor(Math.random() * 6)],
                maxCombo: Math.floor(Math.random() * 8) + 1,
                skillsUsed: {
                    threeHeadsSixArms: Math.floor(Math.random() * 3),
                    qiankunCircle: Math.floor(Math.random() * 2),
                    huntianLing: Math.floor(Math.random() * 2),
                    transformation: Math.floor(Math.random() * 1)
                }
            };
            
            stateManager.updateStatistics(mockGameData);
            log(`æ›´æ–°ç»Ÿè®¡: åˆ†æ•°=${mockGameData.score}, è·èƒœ=${mockGameData.isWon}, æœ€å¤§æ–¹å—=${mockGameData.maxTile}`);
            updateStatus('ç»Ÿè®¡æ•°æ®å·²æ›´æ–°', 'success');
        }
        
        // æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
        function displayStatistics() {
            const stats = stateManager.getStatistics();
            const statsDisplay = document.getElementById('statistics-display');
            
            statsDisplay.innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">æ€»æ¸¸æˆæ•°</div>
                    <div class="stat-value">${stats.totalGames}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æ€»åˆ†æ•°</div>
                    <div class="stat-value">${stats.totalScore.toLocaleString()}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">å¹³å‡åˆ†</div>
                    <div class="stat-value">${stats.averageScore}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æœ€ä½³åˆ†æ•°</div>
                    <div class="stat-value">${stats.bestScore.toLocaleString()}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æœ€å¤§æ–¹å—</div>
                    <div class="stat-value">${stats.bestTile}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æ€»ç§»åŠ¨æ•°</div>
                    <div class="stat-value">${stats.totalMoves.toLocaleString()}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æ€»æ¸¸æˆæ—¶é—´</div>
                    <div class="stat-value">${Math.floor(stats.totalPlayTime / 60000)}åˆ†é’Ÿ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">èƒœç‡</div>
                    <div class="stat-value">${stats.winRate}%</div>
                </div>
            `;
        }
        
        // æµ‹è¯•é‡ç½®ç»Ÿè®¡
        function testResetStatistics() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰ç»Ÿè®¡æ•°æ®å—ï¼Ÿ')) {
                stateManager.resetStatistics();
                log('ç»Ÿè®¡æ•°æ®å·²é‡ç½®');
                updateStatus('ç»Ÿè®¡æ•°æ®å·²é‡ç½®', 'success');
            }
        }
        
        // æµ‹è¯•è§£é”æˆå°±
        function testUnlockAchievement() {
            const mockGameData = {
                score: 60000,
                isWon: true,
                playTime: 240000,
                maxCombo: 7,
                maxTile: 4096
            };
            
            stateManager.checkAchievements(mockGameData);
            log('æˆå°±æ£€æŸ¥å®Œæˆ');
            updateStatus('æˆå°±æ£€æŸ¥å®Œæˆ', 'success');
        }
        
        // æ˜¾ç¤ºæˆå°±
        function displayAchievements() {
            const achievements = stateManager.getAchievements();
            const achievementsDisplay = document.getElementById('achievements-display');
            
            let html = '';
            Object.keys(achievements).forEach(key => {
                const achievement = achievements[key];
                const isUnlocked = achievement.unlocked;
                
                html += `
                    <div class="achievement-item ${isUnlocked ? 'unlocked' : 'locked'}">
                        <div class="achievement-icon">${isUnlocked ? 'ğŸ†' : 'ğŸ”’'}</div>
                        <div class="achievement-info">
                            <h4>${achievement.name}</h4>
                            <p>${achievement.description}</p>
                        </div>
                    </div>
                `;
            });
            
            achievementsDisplay.innerHTML = html;
            
            const unlockedCount = stateManager.getUnlockedAchievementsCount();
            const totalCount = Object.keys(achievements).length;
            log(`æˆå°±è¿›åº¦: ${unlockedCount}/${totalCount}`);
        }
        
        // æµ‹è¯•æ£€æŸ¥æˆå°±
        function testCheckAchievements() {
            // æ¨¡æ‹Ÿå„ç§æ¸¸æˆæ•°æ®æ¥è§¦å‘ä¸åŒæˆå°±
            const testCases = [
                { score: 55000, isWon: true, playTime: 180000, maxCombo: 4, maxTile: 2048 },
                { score: 30000, isWon: true, playTime: 250000, maxCombo: 6, maxTile: 1024 },
                { score: 80000, isWon: true, playTime: 400000, maxCombo: 8, maxTile: 4096 }
            ];
            
            testCases.forEach((testCase, index) => {
                setTimeout(() => {
                    stateManager.checkAchievements(testCase);
                    log(`æˆå°±æµ‹è¯• ${index + 1} å®Œæˆ`);
                }, index * 500);
            });
            
            updateStatus('æˆå°±æµ‹è¯•åºåˆ—å·²å¯åŠ¨', 'success');
        }
        
        // æµ‹è¯•å­˜å‚¨æ“ä½œ
        function testStorageOperations() {
            const testData = {
                testKey: 'testValue',
                number: 12345,
                array: [1, 2, 3, 4, 5],
                object: { nested: { value: 'test' } }
            };
            
            // æµ‹è¯•å­˜å‚¨
            stateManager.setItem('test_data', testData);
            
            // æµ‹è¯•è¯»å–
            const retrievedData = stateManager.getItem('test_data');
            
            // æµ‹è¯•åˆ é™¤
            stateManager.removeItem('test_data');
            const deletedData = stateManager.getItem('test_data', 'not found');
            
            const result = `
å­˜å‚¨æµ‹è¯•ç»“æœ:
åŸå§‹æ•°æ®: ${JSON.stringify(testData, null, 2)}
è¯»å–æ•°æ®: ${JSON.stringify(retrievedData, null, 2)}
åˆ é™¤åè¯»å–: ${deletedData}
            `;
            
            document.getElementById('storage-test-result').textContent = result;
            log('å­˜å‚¨æ“ä½œæµ‹è¯•å®Œæˆ');
            updateStatus('å­˜å‚¨æ“ä½œæµ‹è¯•å®Œæˆ', 'success');
        }
        
        // æµ‹è¯•å­˜å‚¨ä½¿ç”¨æƒ…å†µ
        function testStorageUsage() {
            const usage = stateManager.getStorageUsage();
            
            const result = `
å­˜å‚¨ä½¿ç”¨æƒ…å†µ:
æ”¯æŒæœ¬åœ°å­˜å‚¨: ${usage.supported}
å·²ä½¿ç”¨ç©ºé—´: ${usage.used} å­—èŠ‚
æ€»ç©ºé—´: ${usage.total} å­—èŠ‚
ä½¿ç”¨ç™¾åˆ†æ¯”: ${usage.percentage ? usage.percentage.toFixed(2) + '%' : 'N/A'}
${usage.error ? 'é”™è¯¯: ' + usage.error : ''}
            `;
            
            document.getElementById('storage-test-result').textContent = result;
            log(`å­˜å‚¨ä½¿ç”¨æƒ…å†µ: ${usage.used}/${usage.total} å­—èŠ‚`);
            updateStatus('å­˜å‚¨ä½¿ç”¨æƒ…å†µå·²è·å–', 'success');
        }
        
        // æµ‹è¯•æ•°æ®å¯¼å‡º
        function testDataExport() {
            const exportedData = stateManager.exportData();
            
            document.getElementById('storage-test-result').textContent = 
                'å¯¼å‡ºçš„æ•°æ®:\n' + JSON.stringify(exportedData, null, 2);
            
            log('æ•°æ®å¯¼å‡ºå®Œæˆ');
            updateStatus('æ•°æ®å¯¼å‡ºå®Œæˆ', 'success');
        }
        
        // æµ‹è¯•æ•°æ®å¯¼å…¥
        function testDataImport() {
            const mockImportData = {
                statistics: {
                    totalGames: 50,
                    totalScore: 500000,
                    bestScore: 75000
                },
                achievements: {
                    firstWin: { unlocked: true, name: 'åˆæ¬¡èƒœåˆ©', description: 'ç¬¬ä¸€æ¬¡è¾¾åˆ°2048' }
                },
                highScore: 75000,
                settings: {
                    volume: 0.8,
                    theme: 'nezha'
                }
            };
            
            stateManager.importData(mockImportData);
            
            document.getElementById('storage-test-result').textContent = 
                'å¯¼å…¥çš„æ•°æ®:\n' + JSON.stringify(mockImportData, null, 2);
            
            log('æ•°æ®å¯¼å…¥å®Œæˆ');
            updateStatus('æ•°æ®å¯¼å…¥å®Œæˆ', 'success');
        }
        
        // æµ‹è¯•å®Œå…¨é‡ç½®
        function testResetGame() {
            if (confirm('ç¡®å®šè¦å®Œå…¨é‡ç½®æ¸¸æˆå—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰æ•°æ®ï¼')) {
                stateManager.resetGame();
                
                // åˆ·æ–°æ˜¾ç¤º
                displayStatistics();
                displayAchievements();
                
                document.getElementById('storage-test-result').textContent = 'æ¸¸æˆå·²å®Œå…¨é‡ç½®';
                log('æ¸¸æˆå·²å®Œå…¨é‡ç½®');
                updateStatus('æ¸¸æˆå·²å®Œå…¨é‡ç½®', 'success');
            }
        }
        
        // æ·»åŠ CSSåŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>